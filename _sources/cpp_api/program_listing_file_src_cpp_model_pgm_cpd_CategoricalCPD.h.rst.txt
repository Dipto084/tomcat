
.. _program_listing_file_src_cpp_model_pgm_cpd_CategoricalCPD.h:

Program Listing for File CategoricalCPD.h
=========================================

|exhale_lsh| :ref:`Return to documentation for file <file_src_cpp_model_pgm_cpd_CategoricalCPD.h>` (``src/cpp/model/pgm/cpd/CategoricalCPD.h``)

.. |exhale_lsh| unicode:: U+021B0 .. UPWARDS ARROW WITH TIP LEFTWARDS

.. code-block:: cpp

   #pragma once
   
   #include "../../utils/Definitions.h"
   #include "../../distribution/Categorical.h"
   #include "CPD.h"
   
   namespace tomcat {
       namespace model {
   
           class CategoricalCPD : public CPD {
             public:
               //------------------------------------------------------------------
               // Constructors & Destructor
               //------------------------------------------------------------------
   
               CategoricalCPD(
                   std::vector<std::shared_ptr<NodeMetadata>>& parent_node_order,
                   const std::vector<std::shared_ptr<Categorical>>& distributions);
   
               CategoricalCPD(
                   std::vector<std::shared_ptr<NodeMetadata>>&& parent_node_order,
                   const std::vector<std::shared_ptr<Categorical>>& distributions);
   
               CategoricalCPD(
                   std::vector<std::shared_ptr<NodeMetadata>>& parent_node_order,
                   const Eigen::MatrixXd& probabilities);
   
               CategoricalCPD(
                   std::vector<std::shared_ptr<NodeMetadata>>&& parent_node_order,
                   const Eigen::MatrixXd& probabilities);
   
               ~CategoricalCPD();
   
               //------------------------------------------------------------------
               // Copy & Move constructors/assignments
               //------------------------------------------------------------------
               CategoricalCPD(const CategoricalCPD& cpd);
   
               CategoricalCPD& operator=(const CategoricalCPD& cpd);
   
               CategoricalCPD(CategoricalCPD&& cpd) = default;
   
               CategoricalCPD& operator=(CategoricalCPD&& cpd) = default;
   
               //------------------------------------------------------------------
               // Member functions
               //------------------------------------------------------------------
               std::unique_ptr<CPD> clone() const override;
   
               std::string get_description() const override;
   
               void add_to_sufficient_statistics(
                   const Eigen::VectorXd& sample) override;
   
               Eigen::MatrixXd sample_from_conjugacy(
                   std::shared_ptr<gsl_rng> random_generator,
                   const std::vector<std::shared_ptr<Node>>& parent_nodes,
                   int num_samples) const override;
   
               void reset_sufficient_statistics() override;
   
             protected:
               //------------------------------------------------------------------
               // Member functions
               //------------------------------------------------------------------
               void clone_distributions() override;
   
             private:
               //------------------------------------------------------------------
               // Member functions
               //------------------------------------------------------------------
   
               void init_from_distributions(
                   const std::vector<std::shared_ptr<Categorical>>& distributions);
   
               void init_from_matrix(const Eigen::MatrixXd& matrix);
   
           };
   
       } // namespace model
   } // namespace tomcat
